<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#FF5722 name=theme-color> <meta content="Anonsage dev blog and cheat sheets" name=Description> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.1410966418.css rel=stylesheet><link href=client/client.d4c0ae6b.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Simple sample of Android in-app billing v2 in Kotlin</title><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-12i6fi0><ul class=svelte-12i6fi0><li class=svelte-12i6fi0><a href=. class=svelte-12i6fi0>home</a></li> <li class=svelte-12i6fi0><a href=dev class=svelte-12i6fi0 rel=prefetch aria-current=page>dev</a></li> <li class=svelte-12i6fi0><a href=random class=svelte-12i6fi0 rel=prefetch>random</a></li> <li class=svelte-12i6fi0><a href=anonlang class=svelte-12i6fi0 rel=prefetch>anonlang</a></li> <li class=svelte-12i6fi0><a href=products class=svelte-12i6fi0 rel=prefetch>products</a></ul></nav> <main class=svelte-kr0vyj> <h1>Simple sample of Android in-app billing v2 in Kotlin</h1> <small>2019-05-25</small> <div class=content><p>Over the course of a few days this week, for my side project, I implemented Android in-app billing v2 in Kotlin. It took about 5 hours to read through everything and implement it, but it should have taken less than an hour with the right sample code and walk-through.</p> <p>This is that walk-through that I would have wanted to just quickly implement subscription services in my app.</p> <p>Google, in general, has good documentation for their in-app billing, but their code sample was more helpful for me, even though it wasn't updated for the latest version of the library. There was a major version update with breaking changes that couldn't be copy-pasted into a current app.</p> <p>There are about ten main pages of documentation for in-app billing, but to simply get started and running, you will only need one doc page and one sample code page:</p> <ul> <li><a href=https://developer.android.com/google/play/billing/billing_overview>https://developer.android.com/google/play/billing/billing_overview</a></li> <li><a href=https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive_v2/shared-module/src/main/java/com/example/billingmodule/billing/BillingManager.java>https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive_v2/shared-module/src/main/java/com/example/billingmodule/billing/BillingManager.java</a></li> </ul> <p>Or...</p> <p>I can just provide the highlights and updated code that will actually work...</p> <ul> <li>Product IDs must be unique and can NOT be reused. Product IDs must start with a lowercase letter or a number and must be composed of only lowercase letters (a-z), numbers (0-9), underscores (_), and periods (.). The product ID 'android.test' is unavailable for use, along with all product IDs that start with 'android.test'.</li> <li>Subscriptions can NOT be unpublished</li> <li>Subscription prices must be within a certain price range, US currently USD .99 - 400.00: <a href=https://support.google.com/googleplay/android-developer/table/3541286>https://support.google.com/googleplay/android-developer/table/3541286</a></li> <li>The easiest way to test your purchase flow is to have testers defined in the Google Play Console > Settings > Developer account > Account details > License Testing > 'Gmail accounts with testing access'</li> </ul> <p>Code:</p> <ul> <li>Add <code>implementation 'com.android.billingclient:billing:2.0.0'</code> in your app's build.gradle file</li> <li>Add <code>&lt;uses-permission android:name="com.android.vending.BILLING" /></code> in your app's AndroidManifest.xml file</li> <li>Copy+paste this gist, then change the SKUs for your usage: <a href=https://gist.github.com/danialgoodwin/5bc709b19b776e707a827772401aaf96>https://gist.github.com/danialgoodwin/5bc709b19b776e707a827772401aaf96</a> (shown below)</li> </ul> <p>{% gist user="danialgoodwin" id="5bc709b19b776e707a827772401aaf96" %}</p> <p>From "0" to "it works on my machine" :p</p> </div> <br><br><br> <a href=../dev/2019-05-21-better-programming-language-by-effective-java>&lt;Better programming language by Effective Java</a> <div class=right><a href=../dev/2019-10-03-how-to-connect-postman-to-microsoft-azure-service-bus-via-rest>How to connect Postman to Microsoft Azure Service Bus via REST></a></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{html:"\u003Cp\u003EOver the course of a few days this week, for my side project, I implemented Android in-app billing v2 in Kotlin. It took about 5 hours to read through everything and implement it, but it should have taken less than an hour with the right sample code and walk-through.\u003C\u002Fp\u003E\n\u003Cp\u003EThis is that walk-through that I would have wanted to just quickly implement subscription services in my app.\u003C\u002Fp\u003E\n\u003Cp\u003EGoogle, in general, has good documentation for their in-app billing, but their code sample was more helpful for me, even though it wasn&#39;t updated for the latest version of the library. There was a major version update with breaking changes that couldn&#39;t be copy-pasted into a current app.\u003C\u002Fp\u003E\n\u003Cp\u003EThere are about ten main pages of documentation for in-app billing, but to simply get started and running, you will only need one doc page and one sample code page:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdeveloper.android.com\u002Fgoogle\u002Fplay\u002Fbilling\u002Fbilling_overview\"\u003Ehttps:\u002F\u002Fdeveloper.android.com\u002Fgoogle\u002Fplay\u002Fbilling\u002Fbilling_overview\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgooglesamples\u002Fandroid-play-billing\u002Fblob\u002Fmaster\u002FTrivialDrive_v2\u002Fshared-module\u002Fsrc\u002Fmain\u002Fjava\u002Fcom\u002Fexample\u002Fbillingmodule\u002Fbilling\u002FBillingManager.java\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fgooglesamples\u002Fandroid-play-billing\u002Fblob\u002Fmaster\u002FTrivialDrive_v2\u002Fshared-module\u002Fsrc\u002Fmain\u002Fjava\u002Fcom\u002Fexample\u002Fbillingmodule\u002Fbilling\u002FBillingManager.java\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EOr...\u003C\u002Fp\u003E\n\u003Cp\u003EI can just provide the highlights and updated code that will actually work...\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EProduct IDs must be unique and can NOT be reused. Product IDs must start with a lowercase letter or a number and must be composed of only lowercase letters (a-z), numbers (0-9), underscores (_), and periods (.). The product ID &#39;android.test&#39; is unavailable for use, along with all product IDs that start with &#39;android.test&#39;.\u003C\u002Fli\u003E\n\u003Cli\u003ESubscriptions can NOT be unpublished\u003C\u002Fli\u003E\n\u003Cli\u003ESubscription prices must be within a certain price range, US currently USD .99 - 400.00: \u003Ca href=\"https:\u002F\u002Fsupport.google.com\u002Fgoogleplay\u002Fandroid-developer\u002Ftable\u002F3541286\"\u003Ehttps:\u002F\u002Fsupport.google.com\u002Fgoogleplay\u002Fandroid-developer\u002Ftable\u002F3541286\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EThe easiest way to test your purchase flow is to have testers defined in the Google Play Console &gt; Settings &gt; Developer account &gt; Account details &gt; License Testing &gt; &#39;Gmail accounts with testing access&#39;\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ECode:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EAdd \u003Ccode\u003Eimplementation &#39;com.android.billingclient:billing:2.0.0&#39;\u003C\u002Fcode\u003E in your app&#39;s build.gradle file\u003C\u002Fli\u003E\n\u003Cli\u003EAdd \u003Ccode\u003E&lt;uses-permission android:name=&quot;com.android.vending.BILLING&quot; \u002F&gt;\u003C\u002Fcode\u003E in your app&#39;s AndroidManifest.xml file\u003C\u002Fli\u003E\n\u003Cli\u003ECopy+paste this gist, then change the SKUs for your usage: \u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fdanialgoodwin\u002F5bc709b19b776e707a827772401aaf96\"\u003Ehttps:\u002F\u002Fgist.github.com\u002Fdanialgoodwin\u002F5bc709b19b776e707a827772401aaf96\u003C\u002Fa\u003E (shown below)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E{% gist user=&quot;danialgoodwin&quot; id=&quot;5bc709b19b776e707a827772401aaf96&quot; %}\u003C\u002Fp\u003E\n\u003Cp\u003EFrom &quot;0&quot; to &quot;it works on my machine&quot; :p\u003C\u002Fp\u003E\n",title:"Simple sample of Android in-app billing v2 in Kotlin",tags:["Android","Kotlin"],file:"2019-05-25-simple-sample-android-in-app-billing-v2-in-kotlin.md",date:"2019-05-25",slug:"2019-05-25-simple-sample-android-in-app-billing-v2-in-kotlin",next:{slug:"2019-10-03-how-to-connect-postman-to-microsoft-azure-service-bus-via-rest",name:"How to connect Postman to Microsoft Azure Service Bus via REST"},previous:{slug:"2019-05-21-better-programming-language-by-effective-java",name:"Better programming language by Effective Java"}}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.d4c0ae6b.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.d4c0ae6b.js")}document.head.appendChild(s)</script> <script async data-goatcounter=https://anonsage.goatcounter.com/count src=//gc.zgo.at/count.js></script> 